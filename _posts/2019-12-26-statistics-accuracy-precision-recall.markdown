---  
layout: post  
title: "[Statistics] 모델 성능 측정을 위해 precision, recall 표로 쉽게 계산하기"  
subtitle: "statistics"  
categories: statistics  
tags: statistics deep learning model performance accuracy precision recall f1-score
comments: true  
header-img: img/statistics/ml_main_img.jpg
published: true
---  
  
## 개요  
> 본 문서는 youtube 영상 ["[머신러닝] 다중 분류 모델 성능 측정 (accuracy, f1 score, precision, recall on multiclass classification)"](https://youtu.be/8DbC39cvvis)를 보고 정리한 글입니다.
  
- 목차  
- [생성 모델링이란?](#생성-모델링이란)  
- [이해를 돕는 사례들](#이해를-돕는-사례들)  
- [딥러닝 숲에서 VAE를 거쳐 GAN까지](#딥러닝-숲에서-vae를-거쳐-gan까지)  
- [이 책의 백미 : 그리기, 글쓰기, 작곡하기, 게임하기](#이-책의-백미--그리기-글쓰기-작곡하기-게임하기)
  
  
## 생성 모델링이란? 
---  
판별 모델링에만 익숙했던 대부분의 머신러닝 엔지니어에게 생성 모델링은 처음 접하는 순간부터 직관적으로 와 닿지는 않는생소한 개념이다. 확률과 통계는 이제 다 배웠다고 안심하고 책을 덮는 순간부터 다른 악마로 나타나 처음부터 다시 공부해야 한다더니만... 생성 모델링이 어렵게 느껴지는 이유 중 하나도 확률적 랜덤요소를 활용하기 때문이다.

`조건부확률 - 베이즈정리 - 나이브베이즈`라는 그 흔한 테크트리가 다시 등장한다.  본 도서에서는 아래와 같이 판별모델링과의 비교를 통해 생성 모델링에 대한 이해도를 높혀준다.

* 판별 모델링 : 
   + `p(y|x)` 
   + 샘플 x가 레이블(카테고리) y일 확률을 추정. 
   + 예 : 추천시스템, 이메일의 긍정/부정 추정, 사진을 통한 녹내장 발생확률 추정 등
* 생성 모델링 :  
   + `p(x|y)`
   + 레이블(카테고리) y를 통해 샘플x일 확률을 추정. 즉, 원본 데이터셋에 속할 가능성이 높은 픽셀을 출력하는 모델링. 
   + 확률적 랜덤요소를 고려하여 샘플링한 데이터셋을 생성하는 방법. 
   + 예 : GAN
![생성모델링](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-2.jpg)

생성 모델링이 의미가 있는 이유는 판별 모델링이 해낼 수 없는 AI 특성을 가지고 있기 때문이다. 강화학습의 시행착오, 사람의 인지능력을 모방하는데 핵심적인 도구로 활용된다. 

그렇다면 도대체 어떻게 생성한다는 것인가? 본 도서에서는 아래 그림과 같이 `간단한 생성 모델링 프레임워크` 예제를 통해 P model에서 포인트 A, B, C를 생성하는 방법과 성공여부를 측정하는 방식을 알려준다. 더불어 핵심 개념을 파악하기 용이하게 끔 표본공간, 확률밀도함수, 모수모델, 가능도, 최대가능도추정 등 핵심 확률 개념을 다시금 짚어준다. 
![생성모델링프레임워크](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-5.jpg)

  
## 이해를 돕는 사례들
---  
이 책이 가지는 흥미로운 부분은 각 장별로 이해를 돕기위해 일상생활과 유사한 사례를 예로 든다는 점이다. 예를 들면 위에서 설명한 생성 모델링을 이해시키기 위해 아래 그림과 같은 로들행성과 픽셀행성에서의 새로운 패션 스타일을 창조하기 위한 방법을 마치 소설과 같이 설명해준다. 

소설은 수학적 지식이 전무한 분들이나 문과출신 분들도 이해하는데 무리가 없기에 이해되지 않는 수식이나 용어들과 싸우는 대신 개념과 활용 용도를 파악하는데 있어 상당히 효과적인 방법이라고 생각한다. GAN을 접하는데 있어 이렇게 쉬운 방법으로 접근하는 책은 처음인 것 같다.
![로들행성](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-3.jpg)
![픽셀행성](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-4.jpg)

먼저 로들행성에서 위 그림과 같은 50개의 패션 샘플을 바탕으로 `고수준 특성(머리모양, 색깔, 안경여부, 옷 등)`만을 바탕으로 가법 평활화 등을 활용하여 새로운 패션을 생성하는 방법을 예로 든다. 반면 픽셀행성 예제에서는 고수준 특성을 포함하여 `저수준 특성(픽셀의 가로 x 세로 갯수, RGB)`까지 고려하여 표현학습과 비선형 매니폴드의 개념을 학습한다. 

로들행성이 일반적인 데이터사이언스의 관점에서 접근한다면, 픽셀행성은 보다 심화된 딥러닝의 시각에서 접근하는데 두 예제만큼 딥러닝에서 GAN으로 매끄럽게 설명을 이어나가는 예제는 찾기 힘든것 같다. 상세히 정리하고 싶지만 리뷰 취지에는 벗어나기에 이 즈음에서 마무리하며 더 궁금하신 분들은 책을 참고하시기 바란다.

## 딥러닝 숲에서 VAE를 거쳐 GAN까지
---  
딥러닝을 학습하다보면 자칫 활성화함수, 배치 정규화, 드롭아웃, 경사하강법, 오차역전파법 등 딥러닝을 이루는 세부 요소와 원리에 깊이 빠져들어 딥러닝의 숲을 이해하지 못하고 주화입마에 빠지는 경우가 종종 발생한다. 나아가 월드모델과 같은 최신 논문 혹은 기술이 등장하면 현재 학습하고 있는 딥러닝 좌표를 잃어버리고 헤매이게 된다.  
  
무수히 많은 수식과 기본개념, 학습속도로 도저히 쫓아갈 수 없는 쏟아지는 최신 논문과 연구결과 속에서 본 도서는 현재 학습하고 있는 전체를 아우를 수 있는 큰 그림으로 학습중인 내용이 어느 위치에 해당하는지 명확한 좌표를 제시해준다. 2 ~ 4장에서 소개되는 지식들은 GAN을 구현하기 위해 반드시 알아야 할 필수 개념들이다.

먼저 GAN에서 활용되는 딥러닝의 핵심 기술들과 개념들을 자세히 알아본다. 아래 그림은 간단한 예제실습을 통해 알아본 CNN에 관한 설명이다.
![CNN](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-6.jpg)

더불어 딥러닝의 필수 개념중 하나인 오토인코더(AE)를 비롯 그 한계를 뛰어넘기위해 사용된 변이형 오토인코더(VAE)에 대해 학습한다. 아래 그림은 VAE에 대한 소개 중 일부이다.
![VAE](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-7.jpg)

VAE까지 학습하고나면 생성모델링에 대해 제법 가시적인 개념이 형성된다. GAN의 핵심개념부터 비교적 최신 연구결과인 WGAN-GP까지 정리하면 비로소 GAN의 기술들에 대한 큰 그림이 보이기 시작한다.
![GAN](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-8.jpg)
![WGAN-GP](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-9.jpg)

이렇듯 책의 구성이 전반적으로 Top-Down의 구조를 체계적으로 그려준다. 현존하는 최신기술들을 한눈에 정리해줌으로써 앞으로의 방향을 잃지 않게 해준다. 방향을 잃지않게 큰 그림과 개념을 지속적으로 잡아준다는 점. 바로 이 점이 본 도서의 뛰어난 매력중 하나이다.  
  
## 이 책의 백미 : 그리기, 글쓰기, 작곡하기, 게임하기  
---  
이로써 딥러닝부터 GAN에 이르까지 핵심개념과 기초를 탄탄히 학습하였다. 이제 이 책의 백미인 주옥같은 감성넘치는 예제들을 실습하며 GAN의 실체를 가시적으로 살펴볼 단계이다.

* __그리기__ 
   + 역시나 초반부는 이해를 돕기위한 사례 소설이 또 등장한다. 사과를 파는 그래니 스미스와 오렌지를 파는 플로리다의 경쟁을 통해 CycleGAN의 핵심원리를 설명한다. `CycleGAN`을 통해 마치 고흐와 같은 아티스트가 시진의 풍경을 보고 그린듯한 결과를 생성할 수 있다.
   + 더불어 `뉴럴 스타일 트랜스퍼 기법`을 통해 특정이미지의 스타일을 원본 이미지로 옮기는 방법을 구현한다. CycleGAN이 특정 화가의 기풍을 학습한 결과라면, 뉴럴 스타일 트랜스퍼의 경우 특정 작품을 학습한다고 비유해야 할까?

* __쓰기__
   + 한 교도관이 죄수들을 이용하여 자신의 단편소설을 쓰게 하는 흥미로운 예제로 출발한다.
   + `LSTM, GRU` 등의 순환층을 활용하여 특정 글의 스타일을 흉내낸 텍스트 시퀀스를 생성하는 방법에 대해 배운다.

* __작곡하기__
   + 바흐의 첼로모음곡을 활용하여 옥타브, 키와 같은 개념을 학습한다.
   + 어텐션 기법을 활용하여 `적층 LSTM, MuseGAN`의 기술을 실습한다.

* __게임하기__
   + `오픈AI Gym` 라이브러리를 활용하여 자동차 경주를 학습한다.
   + 아래 그림과 같은 `월드모델`을 활용하는데 VAE 생성모델에 강화학습을 접목한 방식이다. 개인적으로는 이 실습이 가장 흥미로웠고 GAN과 Reinforcement Learning을 동시에 학습할 수 있어서 가장 배운것이 많은 챕터였다. 생성모델을 의사환경으로 사용하여 전략 정책을 반복하는 기법인데 예전에 알파고와 유사한 것을 만들다가 어려운 난이도에 봉착했던 정책망에 대한 해결책을 얻을 수 있어서 뿌듯했다.
![월드모델](https://theorydb.github.io/assets/img/review/2019-12-12-review-book-GAN-10.jpg)